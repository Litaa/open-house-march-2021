"0","library(sp)"
"0","library(maps)"
"0","library(maptools)"
"0","library(leaflet)"
"0","library(glue)"
"0",""
"0","world <- map(""world"", fill=TRUE, plot=FALSE)"
"0","world_map <- map2SpatialPolygons(world, sub("":.*$"", """", world$names))"
"0","world_map <- SpatialPolygonsDataFrame(world_map,"
"0","                                      data.frame(country=names(world_map), "
"0","                                                 stringsAsFactors=FALSE), "
"0","                                      FALSE)"
"0",""
"0","target <- subset(world_map, country %in% plotdata$country)"
"0","target_sf <- sf::st_as_sf(target)"
"0","# "
"0","target_sf <- target_sf %>%"
"0","  left_join(plotdata, by = c(""country""))# %>%"
"0",""
"0","pal <- colorNumeric(palette = ""YlOrRd"", domain = target_sf$total)"
"0",""
"0","labels <- glue(""<b>{target_sf$country}</b><br>"
"0","    Number of Daily Vaccine: {prettyNum(target_sf$total, big.mark = ',')}"") %>%"
"0","    lapply(htmltools::HTML)"
"0",""
"0",""
"0","leaflet(target_sf) %>% "
"0","  addTiles() %>% "
"0","  addPolygons(weight=2,"
"0","              label=labels,"
"0","              fillColor = ~pal(target_sf$total),"
"0","              fillOpacity = .8,"
"0","              color = ""grey"","
"0","              highlight = highlightOptions("
"0","                weight = 2,"
"0","                color = ""black"","
"0","                bringToFront = TRUE,"
"0","                opacity = 0.8"
"0","              ))%>% "
"0","  addLegend("
"0","    pal = pal,"
"0","    values = ~total,"
"0","    labels = ~total,"
"0","    opacity = 1,"
"0","    title = ""Vaccine Number :"","
"0","    position = ""bottomright"""
"0","  ) "
